#:kivy 2.3.1

<ReceiverFindScreen>:
    name: "receiver_find"
    md_bg_color: self.theme_cls.backgroundColor
    search_indicator: search_indicator
    receiver_rv: receiver_rv

    MDIconButton:
        icon: "arrow-left"
        x: dp(10)
        top: Window.height - dp(10)
        on_release:
            app.change_root_screen("main")

    MDBoxLayout:
        orientation: "vertical"
        size_hint: 0.8, 1
        pos_hint: {"center_x": 0.5}
        padding: 0, 0, 0, dp(bottom_bar.height)# + (dp(searching_layout.height) if root.searching else 0)
        spacing: dp(10)

        MDLabel:
            id: app_title
            text: "ZapFS"
            bold: True
            adaptive_height: True
            halign: "center"
            theme_font_size: "Custom"
            font_size: sp(72)
            text_color: self.theme_cls.onBackgroundColor

        MDBoxLayout:
            id: temp
            adaptive_height: True
            size_hint_x: 1
            pos_hint: {"center_x": 0.5}
            top: app_title.y - dp(20) - self.height * 0
            orientation: "vertical"

            MDLabel:
                text: "Discovered Receivers"
                adaptive_height: True
                font_style: "Headline"
                role: "large"
                bold: True

        MDRecycleView:
            id: receiver_rv
            viewclass: "ReceiverItem"
            RecycleBoxLayout:
                size_hint: 1, None
                # height: temp.y - bottom_bar.top - dp(10)
                # height: min(self.minimum_height, temp.y - bottom_bar.top - dp(10))
                height: self.minimum_height

                default_size_hint: 1, None
                default_size: None, None

                orientation: "vertical"
                spacing: dp(10)
                padding: dp(10)


    MDBoxLayout:
        id: bottom_bar
        adaptive_height: True
        size_hint_x: 0.8
        pos_hint: {"center_x": 0.5}
        # y: dp(10)
        orientation: "vertical"
        spacing: dp(10)
        padding: dp(20)

        # MDDivider:

        MDLinearProgressIndicator:
            id: search_indicator
            type: "indeterminate"
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

        MDButton:
            radius: dp(10)
            style: "filled"
            pos_hint: {"center_x": 0.5}
            on_release: root.on_cancel_search_btn()
            MDButtonText:
                text: "Stop Search"


<ReceiverItem>:
    radius: 10
    spacing: dp(10)
    padding: dp(15), dp(10)
    adaptive_height: True
    size_hint_x: 1
    on_release:
        self.callback(self.ip)

    md_bg_color: self.theme_cls.surfaceContainerLowColor

    MDBoxLayout:
        md_bg_color: self.theme_cls.surfaceContainerHighestColor
        adaptive_size: True
        pos_hint: {"center_y": 0.5}
        padding: dp(10)
        radius: root.radius[0]
        MDIcon:
            icon: "laptop"
            pos_hint: {"center_y": 0.5}
            theme_font_size: "Custom"
            font_size: sp(30)
            text_color: self.theme_cls.onSurfaceColor

    MDBoxLayout:
        orientation: "vertical"
        adaptive_height: True

        MDLabel:
            adaptive_height: True
            text: root.device_name
            pos_hint: {"center_y": 0.5, "center_x": 0.5}
            font_style: "Title"
            role: "large"

            shorten: True
            shorten_from: "left"

        MDLabel:
            adaptive_height: True
            text: root.ip
            pos_hint: {"center_y": 0.5, "center_x": 0.5}
            font_style: "Body"
            role: "large"
            theme_text_color: "Custom"
            text_color: self.theme_cls.disabledTextColor